<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="comle.user">
	<select id="getUserListData" parameterType="java.util.Map" resultType="java.util.Map" >
		select st.subofficename,t.*
			,date_format(createdate, '%Y-%m-%d') createdateStr,
			case when sex = 'F' then '女' 
            else '男' end  sexStr
		from t_sys_user t
    	left join t_s_suboffice st on t.subofficeid = st.subofficeid
			where 1=1 and t.isdisabled=0
		<if test="username != null and username != ''">
			and t.username like CONCAT('%',#{username},'%')
		</if>
	</select>
	<!-- 用户插入 -->
	<insert id="insertUser" parameterType="com.lion.echart.contract.entity.DemoEntity">
           insert into t_sys_user(contractName) 
               values(${contractName})
   </insert>
   <update id="updateUser" parameterType="com.lion.echart.contract.entity.DemoEntity">
   		update t_sys_user 
   		set contractName = #{contractName}
   		where id=#{id}
   </update>
   <!-- 删除用户角色表数据 -->
   <delete id="deleteUserRole" parameterType="java.util.Map" >
		delete from t_sys_user_role
    	where userid = #{userid}
    </delete>
   <!-- 删除用户 -->
   <update id="deleteUser" parameterType="java.util.Map">
    	update t_sys_user
    	set isdisabled = 1
    	where 1=1
		<if test="idList!=null and idList.size()!=0">
	    	and id in
			<foreach collection="idList" item="idList" index="index" open="(" close=")" separator=",">
			  #{idList}
			</foreach>
		</if>
    </update>
</mapper>